<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <script
      src="https://cdn.tiny.cloud/1/qb96lh7jcaqiduzf7cxzdlqkjo7bo9zvvyxwho542vxfpgeb/tinymce/5/tinymce.min.js"
      referrerpolicy="origin"
    ></script>

    <script>
      const pageConfig = {
        size: "large",
        title: "GeoGebra", // The dialog's title - displayed in the dialog header
        body: {
          type: "panel", // The root body type - a Panel or TabPanel
          items: [
            // A list of panel components
            {
              type: "htmlpanel", // an HTML panel component
              html:
                "<script src='https://www.geogebra.org/apps/deployggb.js'><\/script>" +
                "<script>" +
                "var params = {appName: 'graphing',width: window.screen.width - 100," +
                "height: window.screen.height - 150,showToolBar:" +
                "true,showAlgebraInput: true,showMenuBar: true,};" +
                "var applet = new GGBApplet(params, true);" +
                "window.addEventListener('load', function () {applet.inject('ggb-element');});" +
                "<\/script>" +
                "<div id='ggb-element'></div>",
            },
          ],
        },
        buttons: [
          // A list of footer buttons
          {
            type: "custom",
            text: "Save",
          },
        ],
        onAction: () => {
          tinyMCE.activeEditor.setContent("");
          var code = "";
          tinymce.activeEditor.execCommand(
            "mceInsertContent",
            false,
            "<p>HEllo</p>"
            // "<p><div id='applet_container'></div>" +
            //   "<script type='text/javascript' src='https://www.geogebra.org/apps/deployggb.js'><\/script>" +
            //   "<script type='text/javascript'>var params={appName: 'graphing', width: 520, height:" +
            //   "320, showToolBar: false, showAlgebraInput: false, showMenuBar: false, ggbBase64:" +
            //   code +
            //   "};var applet = new GGBApplet(params, true);" +
            //   "window.onload = function () {applet.inject('applet_container');};" +
            //   "<\/script></p>"
          );
        },
      };

      tinymce.init({
        selector: "#mytextarea",
        toolbar: "myCustomToolbarButton",
        setup: function (editor) {
          editor.ui.registry.addButton("myCustomToolbarButton", {
            text: "GeoGebra",
            onAction: function () {
              tinymce.activeEditor.windowManager.open(pageConfig);
            },
          });
        },
      });
    </script>
  </head>

  <body>
    <h1>TinyMCE Quick Start Guide</h1>
    <form method="post">
      <textarea id="mytextarea">Hello, World!</textarea>
    </form>
    <script src="script.js"></script>
  </body>
</html>
